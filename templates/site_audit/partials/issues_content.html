<!-- Issue Lifecycle Summary Cards -->
{% if lifecycle_stats %}
<div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
    <!-- Total Issues Card -->
    <div class="card bg-gradient-to-br from-primary/5 to-primary/10 border border-primary/20">
        <div class="card-body p-4">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-xs font-medium text-base-content/60 uppercase tracking-wider">Total Issues</p>
                    <p class="text-3xl font-bold text-primary mt-1">{{ total_issues|default:0 }}</p>
                </div>
                <div class="w-12 h-12 rounded-full bg-primary/20 flex items-center justify-center">
                    <i class="fas fa-exclamation-triangle text-xl text-primary"></i>
                </div>
            </div>
        </div>
    </div>
    
    <!-- New Issues Card -->
    <div class="card bg-gradient-to-br from-success/5 to-success/10 border border-success/20">
        <div class="card-body p-4">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-xs font-medium text-base-content/60 uppercase tracking-wider">New Issues</p>
                    <p class="text-3xl font-bold text-success mt-1">{{ lifecycle_stats.new_count|default:0 }}</p>
                </div>
                <div class="w-12 h-12 rounded-full bg-success/20 flex items-center justify-center">
                    <i class="fas fa-plus-circle text-xl text-success"></i>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Persisting Issues Card -->
    <div class="card bg-gradient-to-br from-warning/5 to-warning/10 border border-warning/20">
        <div class="card-body p-4">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-xs font-medium text-base-content/60 uppercase tracking-wider">Persisting</p>
                    <p class="text-3xl font-bold text-warning mt-1">{{ lifecycle_stats.persisting_count|default:0 }}</p>
                </div>
                <div class="w-12 h-12 rounded-full bg-warning/20 flex items-center justify-center">
                    <i class="fas fa-sync-alt text-xl text-warning"></i>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Resolved Issues Card -->
    <div class="card bg-gradient-to-br from-info/5 to-info/10 border border-info/20">
        <div class="card-body p-4">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-xs font-medium text-base-content/60 uppercase tracking-wider">Resolved</p>
                    <p class="text-3xl font-bold text-info mt-1">{{ lifecycle_stats.resolved_count|default:0 }}</p>
                </div>
                <div class="w-12 h-12 rounded-full bg-info/20 flex items-center justify-center">
                    <i class="fas fa-check-circle text-xl text-info"></i>
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}

<!-- Issues List -->
<div id="issues-list" class="space-y-4">
    {% include 'site_audit/partials/issues_items.html' %}
    
    {% if not issues %}
    <!-- No Issues Found -->
    <div class="card bg-base-100 shadow-sm border border-base-300">
        <div class="card-body text-center py-12">
            <i class="fas fa-check-circle text-5xl text-success mb-4"></i>
            <h3 class="text-xl font-semibold text-base-content mb-2">No Issues Found!</h3>
            <p class="text-base-content/60">Your website is in excellent condition.</p>
        </div>
    </div>
    {% endif %}
</div>

<!-- Pagination Controls -->
{% if total_pages > 1 %}
<div id="pagination-container" class="mt-8">
    <!-- Results Info -->
    <div class="flex justify-between items-center mb-4">
        <div class="text-sm text-base-content/70">
            Showing 
            <span class="font-semibold">{{ issues_start|default:1 }}</span> - 
            <span class="font-semibold">{{ issues_end|default:issues|length }}</span> 
            of <span class="font-semibold">{{ total_issues|default:0 }}</span> issues
        </div>
        <div class="text-sm text-base-content/70">
            Page <span class="font-semibold">{{ current_page }}</span> of <span class="font-semibold">{{ total_pages }}</span>
        </div>
    </div>
    
    <!-- Pagination Buttons -->
    <div class="join flex justify-center">
        <!-- Previous Button -->
        {% if current_page > 1 %}
        <button class="join-item btn btn-sm"
                hx-get="{% url 'site_audit:detail' audit.id %}?tab=issues&page={{ current_page|add:-1 }}"
                hx-trigger="click"
                hx-target="#issues-content-area"
                hx-swap="innerHTML"
                hx-include="[name='severity'], [name='category'], #issue-search">
            <i class="fas fa-chevron-left"></i>
        </button>
        {% else %}
        <button class="join-item btn btn-sm btn-disabled">
            <i class="fas fa-chevron-left"></i>
        </button>
        {% endif %}
        
        <!-- Page Numbers -->
        {% for page_num in page_range %}
            {% if page_num == '...' %}
                <button class="join-item btn btn-sm btn-disabled">...</button>
            {% elif page_num == current_page %}
                <button class="join-item btn btn-sm btn-active btn-primary">{{ page_num }}</button>
            {% else %}
                <button class="join-item btn btn-sm"
                        hx-get="{% url 'site_audit:detail' audit.id %}?tab=issues&page={{ page_num }}"
                        hx-trigger="click"
                        hx-target="#issues-content-area"
                        hx-swap="innerHTML"
                        hx-include="[name='severity'], [name='category'], #issue-search">
                    {{ page_num }}
                </button>
            {% endif %}
        {% endfor %}
        
        <!-- Next Button -->
        {% if current_page < total_pages %}
        <button class="join-item btn btn-sm"
                hx-get="{% url 'site_audit:detail' audit.id %}?tab=issues&page={{ current_page|add:1 }}"
                hx-trigger="click"
                hx-target="#issues-content-area"
                hx-swap="innerHTML"
                hx-include="[name='severity'], [name='category'], #issue-search">
            <i class="fas fa-chevron-right"></i>
        </button>
        {% else %}
        <button class="join-item btn btn-sm btn-disabled">
            <i class="fas fa-chevron-right"></i>
        </button>
        {% endif %}
    </div>
</div>
{% elif issues %}
<!-- Single Page -->
<div class="text-center mt-8 text-sm text-base-content/70">
    Showing all <span class="font-semibold">{{ total_issues|default:0 }}</span> issues
</div>
{% endif %}