<!-- Issues Tab Content -->
<div class="space-y-6">
    <!-- Issue Lifecycle Summary Cards (Outside of issues-container to prevent duplication) -->
    {% if lifecycle_stats %}
    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
        <!-- Total Issues Card -->
        <div class="card bg-gradient-to-br from-primary/5 to-primary/10 border border-primary/20">
            <div class="card-body p-4">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-xs font-medium text-base-content/60 uppercase tracking-wider">Total Issues</p>
                        <p class="text-3xl font-bold text-primary mt-1">{{ total_issues|default:0 }}</p>
                    </div>
                    <div class="w-12 h-12 rounded-full bg-primary/20 flex items-center justify-center">
                        <i class="fas fa-exclamation-triangle text-xl text-primary"></i>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- New Issues Card -->
        <div class="card bg-gradient-to-br from-success/5 to-success/10 border border-success/20">
            <div class="card-body p-4">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-xs font-medium text-base-content/60 uppercase tracking-wider">New Issues</p>
                        <p class="text-3xl font-bold text-success mt-1">{{ lifecycle_stats.new_count|default:0 }}</p>
                    </div>
                    <div class="w-12 h-12 rounded-full bg-success/20 flex items-center justify-center">
                        <i class="fas fa-plus-circle text-xl text-success"></i>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Persisting Issues Card -->
        <div class="card bg-gradient-to-br from-warning/5 to-warning/10 border border-warning/20">
            <div class="card-body p-4">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-xs font-medium text-base-content/60 uppercase tracking-wider">Persisting</p>
                        <p class="text-3xl font-bold text-warning mt-1">{{ lifecycle_stats.persisting_count|default:0 }}</p>
                    </div>
                    <div class="w-12 h-12 rounded-full bg-warning/20 flex items-center justify-center">
                        <i class="fas fa-sync-alt text-xl text-warning"></i>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Resolved Issues Card -->
        <div class="card bg-gradient-to-br from-info/5 to-info/10 border border-info/20">
            <div class="card-body p-4">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-xs font-medium text-base-content/60 uppercase tracking-wider">Resolved</p>
                        <p class="text-3xl font-bold text-info mt-1">{{ lifecycle_stats.resolved_count|default:0 }}</p>
                    </div>
                    <div class="w-12 h-12 rounded-full bg-info/20 flex items-center justify-center">
                        <i class="fas fa-check-circle text-xl text-info"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endif %}
    
    <!-- Filters and Search -->
    <div class="card bg-base-100 shadow-sm border border-base-300">
        <div class="card-body p-4">
            <div class="flex flex-col lg:flex-row gap-4">
                <!-- Search -->
                <div class="flex-1">
                    <div class="relative">
                        <input type="text" 
                               id="issue-search"
                               placeholder="Search issues by type or URL..." 
                               class="input input-bordered w-full pl-10 h-10"
                               hx-get="{% url 'site_audit:detail' audit.id %}?tab=issues"
                               hx-trigger="keyup changed delay:500ms"
                               hx-target="#issues-content-area"
                               hx-include="[name='severity'], [name='category']">
                        <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-base-content/40"></i>
                    </div>
                </div>
                
                <!-- Filters -->
                <div class="flex gap-2">
                    <!-- Severity Filter -->
                    <select name="severity" class="select select-bordered select-sm min-w-[150px]"
                            hx-get="{% url 'site_audit:detail' audit.id %}?tab=issues"
                            hx-trigger="change"
                            hx-target="#issues-content-area"
                            hx-include="#issue-search, [name='category']">
                        <option value="">All Severities</option>
                        <option value="critical">Critical</option>
                        <option value="high">High Priority</option>
                        <option value="medium">Medium Priority</option>
                        <option value="low">Low Priority</option>
                    </select>
                    
                    <!-- Category Filter -->
                    <select name="category" class="select select-bordered select-sm min-w-[150px]"
                            hx-get="{% url 'site_audit:detail' audit.id %}?tab=issues"
                            hx-trigger="change"
                            hx-target="#issues-content-area"
                            hx-include="#issue-search, [name='severity']">
                        <option value="">All Categories</option>
                        <option value="meta_content">Meta Content</option>
                        <option value="response_code">Response Code</option>
                        <option value="image">Images</option>
                        <option value="technical_seo">Technical SEO</option>
                        <option value="content_quality">Content Quality</option>
                        <option value="security">Security</option>
                    </select>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Issues Content Area (This gets replaced on pagination) -->
    <div id="issues-content-area">
        {% include 'site_audit/partials/issues_content.html' %}
    </div>
</div>

<style>
.htmx-indicator {
    display: none;
}
.htmx-request .htmx-indicator {
    display: block;
}
</style>

